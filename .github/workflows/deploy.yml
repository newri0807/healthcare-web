name: Deploy React
on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: SSH Remote Commands
      uses: appleboy/ssh-action@master
      with:
        host: ${{ secrets.SERVER_HOST }}
        username: ${{ secrets.SERVER_NAME }}
        key: ${{ secrets.SERVER_ACCESS_KEY }}
        script: |
          echo "ğŸš€ React (Vite) 'í´ë¦°' ë°°í¬ ì‹œì‘..."
          
          # 1. ë¬´ì¡°ê±´ ê°•ì œ ì‚­ì œ (ì—ëŸ¬ ë°©ì§€ || true ì¶”ê°€)
          sudo rm -rf /home/ubuntu/deploy/repo-healthcare || true
          
          # 2. ë©”ì¸ ë¸Œëœì¹˜ ê°•ì œ ë‹¤ìš´ë¡œë“œ
          cd /home/ubuntu/deploy
          git clone -b main https://github.com/newri0807/healthcare-web.git repo-healthcare
          
          # 3. ë„ì»¤ ì‹¤í–‰ ìœ„ì¹˜ë¡œ ì´ë™
          cd /home/ubuntu/deploy
          
          # 4. ë„ì»¤ ì‹¤í–‰
          docker compose up -d --build healthcare-web
          
          echo "âœ… React ë°°í¬ ì™„ë£Œ!"
